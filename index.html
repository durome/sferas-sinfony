<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Eduardo Romaguera — Pineal Field V: Cellular Resonance (2025)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Obra generativa de Eduardo Romaguera que une arte contemporáneo, neurociencia y acústica celular. Pineal Field V traduce datos atmosféricos reales de Valencia en frecuencias regenerativas que estimulan la coherencia neuronal y cardíaca.">
  <meta name="keywords" content="Eduardo Romaguera, arte generativo, neuroacústica, arte contemporáneo Valencia, glándula pineal, bioarte, sound art, p5.js, arte interactivo, neuroplasticidad, frecuencias curativas, art and science, digital art, cellular resonance">
  <meta property="og:title" content="Eduardo Romaguera — Pineal Field V: Cellular Resonance (2025)">
  <meta property="og:description" content="Campo generativo de arte y ciencia donde las esferas sonoras activan resonancias celulares y coherencia neuronal a través del sonido y los datos atmosféricos.">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://durome.github.io/assets/pineal_field_v_preview.jpg">
  <meta name="theme-color" content="#000000">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: black;
      overflow: hidden;
      height: 100%;
      width: 100%;
    }
    canvas {
      display: block;
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.2/p5.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.2/addons/p5.sound.min.js"></script>
</head>

<body>
<script>
let spheres = [];
let weather = { temperature: 20, wind: 0, humidity: 50, solar: 1 };
let started = false;

// 🔬 Frecuencias bioacústicas validadas en estudios de neurociencia y biología molecular
const healingFrequencies = {
  cellRegeneration: 111,     // resonancia celular general
  dnaRepair: 528,            // reparación estructural del ADN
  neuralSynchronicity: 40,   // coherencia gamma cerebral
  pinealActivation: 936,     // activación melatonínica y pineal
  heartCoherence: 639,       // campo electromagnético cardíaco
  mitochondrialFlow: 285,    // regeneración tisular
  stemCellResonance: 304     // resonancia acústica en células madre
};

async function fetchWeather() {
  try {
    const response = await fetch(
      "https://api.open-meteo.com/v1/forecast?latitude=39.47&longitude=-0.38&current=temperature_2m,wind_speed_10m,relative_humidity_2m,shortwave_radiation"
    );
    const data = await response.json();
    weather.temperature = data.current.temperature_2m;
    weather.wind = data.current.wind_speed_10m;
    weather.humidity = data.current.relative_humidity_2m;
    weather.solar = data.current.shortwave_radiation || 1;
  } catch (e) {
    console.log("Weather data unavailable, using defaults");
  }
}

function setup() {
  createCanvas(windowWidth, windowHeight, WEBGL);
  colorMode(HSB, 360, 255, 255, 255);
  noStroke();
  fetchWeather();
  setInterval(fetchWeather, 120000);
}

function draw() {
  if (!started) {
    background(0);
    resetMatrix();
    translate(-width / 2, -height / 2);
    fill(255);
    textAlign(CENTER);
    textSize(20);
    text("Click to activate Pineal Field V — Cellular Resonance", width / 2, height / 2);
    return;
  }

  let bgHue = map(weather.solar, 0, 900, 180, 360);
  background(bgHue, 50, 15, 25);
  rotateY(frameCount * 0.001);

  for (let s of spheres) {
    s.update();
    s.display();
  }

  if (frameCount % 10 === 0) {
    let s = new Sphere();
    spheres.push(s);
    s.playHealingTone();
  }

  spheres = spheres.filter(s => !s.dead);
  drawSignature();
}

function mousePressed() {
  userStartAudio();
  started = true;
  startHealingField();
}

class Sphere {
  constructor() {
    this.pos = createVector(random(-300, 300), random(-300, 300), random(-300, 300));
    this.size = map(weather.temperature, -10, 40, 10, 90);
    this.speed = map(weather.wind, 0, 30, 0.02, 0.8);
    this.hue = map(weather.humidity, 0, 100, 180, 360);
    this.life = 255;
    this.dead = false;
  }

  update() {
    this.pos.add(p5.Vector.random3D().mult(this.speed));
    this.life -= 1;
    if (this.life < 0) this.dead = true;
  }

  display() {
    push();
    fill(this.hue, 180, 255, this.life);
    translate(this.pos.x, this.pos.y, this.pos.z);
    sphere(this.size);
    pop();
  }

  // 🎵 Emisión de frecuencias regenerativas individuales
  playHealingTone() {
    const freqs = Object.values(healingFrequencies);
    const f = random(freqs);
    const pan = random(-1, 1);
    const dur = random(3, 5);

    let osc = new p5.Oscillator('sine');
    let env = new p5.Envelope();
    env.setADSR(0.05, 0.8, 0.3, 1.2);
    env.setRange(map(weather.solar, 0, 900, 0.02, 0.1), 0);

    osc.freq(f + random(-0.3, 0.3)); // microvariación biológica
    osc.pan(pan);
    osc.start();
    env.play(osc);

    let ctx = getAudioContext();
    osc.stop(ctx.currentTime + dur);
  }
}

// 🌬️ Campo base atmosférico y resonancia pineal
let pinkNoise, pinealCarrier, heartPulse;

function startHealingField() {
  pinkNoise = new p5.Noise('pink');
  pinkNoise.amp(0.015);
  pinkNoise.start();

  pinealCarrier = new p5.Oscillator('sine');
  pinealCarrier.freq(healingFrequencies.pinealActivation);
  pinealCarrier.amp(0.03, 3);
  pinealCarrier.start();

  heartPulse = new p5.Oscillator('sine');
  heartPulse.freq(healingFrequencies.heartCoherence / 100); // 6.39 Hz ≈ coherencia cardíaca
  heartPulse.amp(0.01);
  heartPulse.start();
}

// ✍️ Firma viva
function drawSignature() {
  push();
  resetMatrix();
  translate(-width / 2, -height / 2);
  let alpha = map(sin(frameCount * 0.01), -1, 1, 100, 255);
  fill(255, alpha);
  textAlign(RIGHT, BOTTOM);
  textFont('Helvetica');
  textSize(14);
  text("Eduardo Romaguera — Pineal Field V: Cellular Resonance (2025)", width - 20, height - 20);
  pop();
}

function windowResized() {
  resizeCanvas(windowWidth, windowHeight);
}
</script>
</body>
</html>
